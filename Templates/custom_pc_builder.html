{% extends 'base.html' %}

{% block title %}Custom PC Builder - PC Builder{% endblock %}

{% block content %}
<div class="container py-5">
    <div class="row mb-4">
        <div class="col-12">
            <h1 class="mb-3">Custom PC Builder</h1>
            <p class="lead">Build your dream PC by selecting compatible components</p>
        </div>
    </div>
    
    <div class="row">
        <div class="col-lg-8">
            <!-- PC Builder Interface -->
            <div class="pc-builder-container p-4 mb-4">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h4 class="mb-0">Select Your Components</h4>
                    <div class="progress flex-grow-1 ms-3" style="height: 10px;">
                        <div id="build-progress" class="progress-bar bg-success" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                </div>
                
                <!-- CPU Selection -->
                <div class="component-section">
                    <div id="cpu-slot" class="component-slot empty">
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <h5 class="component-name">Select a CPU</h5>
                                <p class="text-muted mb-0">Central Processing Unit</p>
                            </div>
                            <div class="col-md-2 text-end">
                                <span class="component-price"></span>
                            </div>
                            <div class="col-md-2 text-end">
                                <button type="button" class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#cpu-modal">
                                    <i class="fas fa-plus"></i>
                                </button>
                                <button type="button" class="btn btn-sm btn-outline-danger component-clear-btn d-none" data-category="cpu">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Motherboard Selection -->
                <div class="component-section">
                    <div id="motherboard-slot" class="component-slot empty">
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <h5 class="component-name">Select a Motherboard</h5>
                                <p class="text-muted mb-0">Main Circuit Board</p>
                            </div>
                            <div class="col-md-2 text-end">
                                <span class="component-price"></span>
                            </div>
                            <div class="col-md-2 text-end">
                                <button type="button" class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#motherboard-modal">
                                    <i class="fas fa-plus"></i>
                                </button>
                                <button type="button" class="btn btn-sm btn-outline-danger component-clear-btn d-none" data-category="motherboard">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- GPU Selection -->
                <div class="component-section">
                    <div id="gpu-slot" class="component-slot empty">
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <h5 class="component-name">Select a GPU</h5>
                                <p class="text-muted mb-0">Graphics Processing Unit</p>
                            </div>
                            <div class="col-md-2 text-end">
                                <span class="component-price"></span>
                            </div>
                            <div class="col-md-2 text-end">
                                <button type="button" class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#gpu-modal">
                                    <i class="fas fa-plus"></i>
                                </button>
                                <button type="button" class="btn btn-sm btn-outline-danger component-clear-btn d-none" data-category="gpu">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- RAM Selection -->
                <div class="component-section">
                    <div id="ram-slot" class="component-slot empty">
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <h5 class="component-name">Select RAM</h5>
                                <p class="text-muted mb-0">Memory</p>
                            </div>
                            <div class="col-md-2 text-end">
                                <span class="component-price"></span>
                            </div>
                            <div class="col-md-2 text-end">
                                <button type="button" class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#ram-modal">
                                    <i class="fas fa-plus"></i>
                                </button>
                                <button type="button" class="btn btn-sm btn-outline-danger component-clear-btn d-none" data-category="ram">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Storage Selection -->
                <div class="component-section">
                    <div id="storage-slot" class="component-slot empty">
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <h5 class="component-name">Select Storage</h5>
                                <p class="text-muted mb-0">SSD/HDD</p>
                            </div>
                            <div class="col-md-2 text-end">
                                <span class="component-price"></span>
                            </div>
                            <div class="col-md-2 text-end">
                                <button type="button" class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#storage-modal">
                                    <i class="fas fa-plus"></i>
                                </button>
                                <button type="button" class="btn btn-sm btn-outline-danger component-clear-btn d-none" data-category="storage">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- PSU Selection -->
                <div class="component-section">
                    <div id="psu-slot" class="component-slot empty">
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <h5 class="component-name">Select a Power Supply</h5>
                                <p class="text-muted mb-0">Power Supply Unit</p>
                            </div>
                            <div class="col-md-2 text-end">
                                <span class="component-price"></span>
                            </div>
                            <div class="col-md-2 text-end">
                                <button type="button" class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#psu-modal">
                                    <i class="fas fa-plus"></i>
                                </button>
                                <button type="button" class="btn btn-sm btn-outline-danger component-clear-btn d-none" data-category="psu">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Case Selection -->
                <div class="component-section">
                    <div id="case-slot" class="component-slot empty">
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <h5 class="component-name">Select a Case</h5>
                                <p class="text-muted mb-0">Computer Case</p>
                            </div>
                            <div class="col-md-2 text-end">
                                <span class="component-price"></span>
                            </div>
                            <div class="col-md-2 text-end">
                                <button type="button" class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#case-modal">
                                    <i class="fas fa-plus"></i>
                                </button>
                                <button type="button" class="btn btn-sm btn-outline-danger component-clear-btn d-none" data-category="case">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Cooling Selection -->
                <div class="component-section">
                    <div id="cooling-slot" class="component-slot empty">
                        <div class="row align-items-center">
                            <div class="col-md-8">
                                <h5 class="component-name">Select CPU Cooling</h5>
                                <p class="text-muted mb-0">CPU Cooler</p>
                            </div>
                            <div class="col-md-2 text-end">
                                <span class="component-price"></span>
                            </div>
                            <div class="col-md-2 text-end">
                                <button type="button" class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#cooling-modal">
                                    <i class="fas fa-plus"></i>
                                </button>
                                <button type="button" class="btn btn-sm btn-outline-danger component-clear-btn d-none" data-category="cooling">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Compatibility Warnings -->
            <div id="compatibility-warnings" class="mb-4"></div>
        </div>
        
        <div class="col-lg-4">
            <!-- Build Summary -->
            <div class="card mb-4">
                <div class="card-header bg-dark">
                    <h5 class="mb-0">Build Summary</h5>
                </div>
                <div class="card-body">
                    <div class="d-flex justify-content-between mb-2">
                        <span>Total Price:</span>
                        <span id="total-price">₹0.00</span>
                    </div>
                    <hr>
                    <div class="d-grid">
                        <button id="add-build-to-cart" class="btn btn-success" disabled>
                            <i class="fas fa-shopping-cart me-2"></i>Add Build to Cart
                        </button>
                    </div>
                    <div class="mt-3">
                        <small class="text-muted">* Select at least CPU, Motherboard, and RAM to continue</small>
                    </div>
                </div>
            </div>
            
            <!-- Building Tips -->
            <div class="card">
                <div class="card-header bg-dark">
                    <h5 class="mb-0">Building Tips</h5>
                </div>
                <div class="card-body">
                    <ul class="list-unstyled">
                        <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Select compatible CPU and motherboard sockets</li>
                        <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Ensure RAM is compatible with your motherboard</li>
                        <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Choose a PSU with sufficient wattage</li>
                        <li class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>Make sure components fit in your case</li>
                        <li><i class="fas fa-check-circle text-success me-2"></i>Consider future upgradeability</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Component Selection Modals -->
<!-- CPU Modal -->
<div class="modal fade" id="cpu-modal" tabindex="-1" aria-labelledby="cpuModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="cpuModalLabel">Select CPU</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="component-picker">
                    <div class="row g-3">
                        {% for cpu in components.cpu %}
                        <div class="col-md-6">
                            <div class="card component-card h-100" data-name="{{ cpu.name }}" data-price="{{ cpu.price }}" data-specs="{{ cpu.specs|tojson }}">
                                <div class="card-body">
                                    <h5 class="card-title">{{ cpu.name }}</h5>
                                    <p class="card-text">{{ cpu.description }}</p>
                                    <ul class="list-unstyled">
                                        <li><small><strong>Socket:</strong> {{ cpu.specs.socket }}</small></li>
                                        <li><small><strong>Cores/Threads:</strong> {{ cpu.specs.cores }}/{{ cpu.specs.threads }}</small></li>
                                        <li><small><strong>Clock Speed:</strong> {{ cpu.specs.base_clock }} - {{ cpu.specs.boost_clock }}</small></li>
                                    </ul>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span class="h5 mb-0">₹{{ "%.2f"|format(cpu.price) }}</span>
                                        <button type="button" class="btn btn-sm btn-primary component-select-btn" data-category="cpu" data-component-id="{{ cpu.id }}">Select</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Motherboard Modal -->
<div class="modal fade" id="motherboard-modal" tabindex="-1" aria-labelledby="motherboardModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="motherboardModalLabel">Select Motherboard</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="component-picker">
                    <div class="row g-3">
                        {% for mb in components.motherboard %}
                        <div class="col-md-6">
                            <div class="card component-card h-100" data-name="{{ mb.name }}" data-price="{{ mb.price }}" data-specs="{{ mb.specs|tojson }}">
                                <div class="card-body">
                                    <h5 class="card-title">{{ mb.name }}</h5>
                                    <p class="card-text">{{ mb.description }}</p>
                                    <ul class="list-unstyled">
                                        <li><small><strong>Socket:</strong> {{ mb.specs.socket }}</small></li>
                                        <li><small><strong>Chipset:</strong> {{ mb.specs.chipset }}</small></li>
                                        <li><small><strong>Memory:</strong> {{ mb.specs.memory_type }}</small></li>
                                    </ul>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span class="h5 mb-0">₹{{ "%.2f"|format(mb.price) }}</span>
                                        <button type="button" class="btn btn-sm btn-primary component-select-btn" data-category="motherboard" data-component-id="{{ mb.id }}">Select</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- GPU Modal -->
<div class="modal fade" id="gpu-modal" tabindex="-1" aria-labelledby="gpuModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="gpuModalLabel">Select GPU</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="component-picker">
                    <div class="row g-3">
                        {% for gpu in components.gpu %}
                        <div class="col-md-6">
                            <div class="card component-card h-100" data-name="{{ gpu.name }}" data-price="{{ gpu.price }}" data-specs="{{ gpu.specs|tojson }}">
                                <div class="card-body">
                                    <h5 class="card-title">{{ gpu.name }}</h5>
                                    <p class="card-text">{{ gpu.description }}</p>
                                    <ul class="list-unstyled">
                                        <li><small><strong>Memory:</strong> {{ gpu.specs.memory }}</small></li>
                                        <li><small><strong>Clock Speed:</strong> {{ gpu.specs.boost_clock }}</small></li>
                                        <li><small><strong>Power:</strong> {{ gpu.specs.power }}</small></li>
                                    </ul>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span class="h5 mb-0">₹{{ "%.2f"|format(gpu.price) }}</span>
                                        <button type="button" class="btn btn-sm btn-primary component-select-btn" data-category="gpu" data-component-id="{{ gpu.id }}">Select</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- RAM Modal -->
<div class="modal fade" id="ram-modal" tabindex="-1" aria-labelledby="ramModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="ramModalLabel">Select RAM</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="component-picker">
                    <div class="row g-3">
                        {% for ram in components.ram %}
                        <div class="col-md-6">
                            <div class="card component-card h-100" data-name="{{ ram.name }}" data-price="{{ ram.price }}" data-specs="{{ ram.specs|tojson }}">
                                <div class="card-body">
                                    <h5 class="card-title">{{ ram.name }}</h5>
                                    <p class="card-text">{{ ram.description }}</p>
                                    <ul class="list-unstyled">
                                        <li><small><strong>Capacity:</strong> {{ ram.specs.capacity }}</small></li>
                                        <li><small><strong>Type:</strong> {{ ram.specs.type }}</small></li>
                                        <li><small><strong>Speed:</strong> {{ ram.specs.speed }}</small></li>
                                    </ul>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span class="h5 mb-0">₹{{ "%.2f"|format(ram.price) }}</span>
                                        <button type="button" class="btn btn-sm btn-primary component-select-btn" data-category="ram" data-component-id="{{ ram.id }}">Select</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Storage Modal -->
<div class="modal fade" id="storage-modal" tabindex="-1" aria-labelledby="storageModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="storageModalLabel">Select Storage</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="component-picker">
                    <div class="row g-3">
                        {% for storage in components.storage %}
                        <div class="col-md-6">
                            <div class="card component-card h-100" data-name="{{ storage.name }}" data-price="{{ storage.price }}" data-specs="{{ storage.specs|tojson }}">
                                <div class="card-body">
                                    <h5 class="card-title">{{ storage.name }}</h5>
                                    <p class="card-text">{{ storage.description }}</p>
                                    <ul class="list-unstyled">
                                        <li><small><strong>Capacity:</strong> {{ storage.specs.capacity }}</small></li>
                                        <li><small><strong>Type:</strong> {{ storage.specs.type }}</small></li>
                                        {% if storage.specs.read_speed %}
                                        <li><small><strong>Read Speed:</strong> {{ storage.specs.read_speed }}</small></li>
                                        {% endif %}
                                    </ul>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span class="h5 mb-0">₹{{ "%.2f"|format(storage.price) }}</span>
                                        <button type="button" class="btn btn-sm btn-primary component-select-btn" data-category="storage" data-component-id="{{ storage.id }}">Select</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- PSU Modal -->
<div class="modal fade" id="psu-modal" tabindex="-1" aria-labelledby="psuModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="psuModalLabel">Select Power Supply</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="component-picker">
                    <div class="row g-3">
                        {% for psu in components.psu %}
                        <div class="col-md-6">
                            <div class="card component-card h-100" data-name="{{ psu.name }}" data-price="{{ psu.price }}" data-specs="{{ psu.specs|tojson }}">
                                <div class="card-body">
                                    <h5 class="card-title">{{ psu.name }}</h5>
                                    <p class="card-text">{{ psu.description }}</p>
                                    <ul class="list-unstyled">
                                        <li><small><strong>Wattage:</strong> {{ psu.specs.wattage }}</small></li>
                                        <li><small><strong>Rating:</strong> {{ psu.specs.rating }}</small></li>
                                        <li><small><strong>Modularity:</strong> {{ psu.specs.modularity }}</small></li>
                                    </ul>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span class="h5 mb-0">₹{{ "%.2f"|format(psu.price) }}</span>
                                        <button type="button" class="btn btn-sm btn-primary component-select-btn" data-category="psu" data-component-id="{{ psu.id }}">Select</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Case Modal -->
<div class="modal fade" id="case-modal" tabindex="-1" aria-labelledby="caseModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="caseModalLabel">Select Case</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="component-picker">
                    <div class="row g-3">
                        {% for case in components.case %}
                        <div class="col-md-6">
                            <div class="card component-card h-100" data-name="{{ case.name }}" data-price="{{ case.price }}" data-specs="{{ case.specs|tojson }}">
                                <div class="card-body">
                                    <h5 class="card-title">{{ case.name }}</h5>
                                    <p class="card-text">{{ case.description }}</p>
                                    <ul class="list-unstyled">
                                        <li><small><strong>Form Factor:</strong> {{ case.specs.form_factor }}</small></li>
                                        <li><small><strong>Color:</strong> {{ case.specs.color }}</small></li>
                                        <li><small><strong>RGB:</strong> {{ case.specs.rgb }}</small></li>
                                    </ul>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span class="h5 mb-0">₹{{ "%.2f"|format(case.price) }}</span>
                                        <button type="button" class="btn btn-sm btn-primary component-select-btn" data-category="case" data-component-id="{{ case.id }}">Select</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Cooling Modal -->
<div class="modal fade" id="cooling-modal" tabindex="-1" aria-labelledby="coolingModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="coolingModalLabel">Select CPU Cooling</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="component-picker">
                    <div class="row g-3">
                        {% for cooling in components.cooling %}
                        <div class="col-md-6">
                            <div class="card component-card h-100" data-name="{{ cooling.name }}" data-price="{{ cooling.price }}" data-specs="{{ cooling.specs|tojson }}">
                                <div class="card-body">
                                    <h5 class="card-title">{{ cooling.name }}</h5>
                                    <p class="card-text">{{ cooling.description }}</p>
                                    <ul class="list-unstyled">
                                        <li><small><strong>Type:</strong> {{ cooling.specs.type }}</small></li>
                                        <li><small><strong>TDP:</strong> {{ cooling.specs.tdp }}</small></li>
                                        <li><small><strong>RGB:</strong> {{ cooling.specs.rgb }}</small></li>
                                    </ul>
                                    <div class="d-flex justify-content-between align-items-center">
                                        <span class="h5 mb-0">₹{{ "%.2f"|format(cooling.price) }}</span>
                                        <button type="button" class="btn btn-sm btn-primary component-select-btn" data-category="cooling" data-component-id="{{ cooling.id }}">Select</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', filename='js/pc_builder.js') }}"></script>
{% endblock %}